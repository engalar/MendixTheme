define(["./sniff","./_base/window","./dom","./dom-style"],(function(t,e,o,r){var n={boxModel:"content-box"};t("ie")&&(n.boxModel="BackCompat"==document.compatMode?"border-box":"content-box"),n.getPadExtents=function(t,e){t=o.byId(t);var n=e||r.getComputedStyle(t),i=r.toPixelValue,d=i(t,n.paddingLeft),l=i(t,n.paddingTop),a=i(t,n.paddingRight),f=i(t,n.paddingBottom);return{l:d,t:l,r:a,b:f,w:d+a,h:l+f}};var i="none";function d(t,e,o,r,n,i){i=i||"px";var d=t.style;isNaN(e)||(d.left=e+i),isNaN(o)||(d.top=o+i),r>=0&&(d.width=r+i),n>=0&&(d.height=n+i)}function l(t){return"button"==t.tagName.toLowerCase()||"input"==t.tagName.toLowerCase()&&"button"==(t.getAttribute("type")||"").toLowerCase()}function a(t){return"border-box"==n.boxModel||"table"==t.tagName.toLowerCase()||l(t)}function f(t){var e,o={x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0};try{e=t.getBoundingClientRect()}catch(t){return o}return void 0===e.left?o:e}n.getBorderExtents=function(t,e){t=o.byId(t);var n=r.toPixelValue,d=e||r.getComputedStyle(t),l=d.borderLeftStyle!=i?n(t,d.borderLeftWidth):0,a=d.borderTopStyle!=i?n(t,d.borderTopWidth):0,f=d.borderRightStyle!=i?n(t,d.borderRightWidth):0,u=d.borderBottomStyle!=i?n(t,d.borderBottomWidth):0;return{l,t:a,r:f,b:u,w:l+f,h:a+u}},n.getPadBorderExtents=function(t,e){t=o.byId(t);var i=e||r.getComputedStyle(t),d=n.getPadExtents(t,i),l=n.getBorderExtents(t,i);return{l:d.l+l.l,t:d.t+l.t,r:d.r+l.r,b:d.b+l.b,w:d.w+l.w,h:d.h+l.h}},n.getMarginExtents=function(t,e){t=o.byId(t);var n=e||r.getComputedStyle(t),i=r.toPixelValue,d=i(t,n.marginLeft),l=i(t,n.marginTop),a=i(t,n.marginRight),f=i(t,n.marginBottom);return{l:d,t:l,r:a,b:f,w:d+a,h:l+f}},n.getMarginBox=function(e,d){e=o.byId(e);var l,a=d||r.getComputedStyle(e),f=n.getMarginExtents(e,a),u=e.offsetLeft-f.l,g=e.offsetTop-f.t,c=e.parentNode,h=r.toPixelValue;return 8!=t("ie")||t("quirks")||c&&(u-=(l=r.getComputedStyle(c)).borderLeftStyle!=i?h(e,l.borderLeftWidth):0,g-=l.borderTopStyle!=i?h(e,l.borderTopWidth):0),{l:u,t:g,w:e.offsetWidth+f.w,h:e.offsetHeight+f.h}},n.getContentBox=function(e,d){e=o.byId(e);var l,a=d||r.getComputedStyle(e),f=e.clientWidth,u=n.getPadExtents(e,a),g=n.getBorderExtents(e,a),c=e.offsetLeft+u.l+g.l,h=e.offsetTop+u.t+g.t;if(f?l=e.clientHeight:(f=e.offsetWidth-g.w,l=e.offsetHeight-g.h),8==t("ie")&&!t("quirks")){var s,b=e.parentNode,y=r.toPixelValue;b&&(c-=(s=r.getComputedStyle(b)).borderLeftStyle!=i?y(e,s.borderLeftWidth):0,h-=s.borderTopStyle!=i?y(e,s.borderTopWidth):0)}return{l:c,t:h,w:f-u.w,h:l-u.h}},n.setContentSize=function(t,e,r){t=o.byId(t);var i=e.w,l=e.h;if(a(t)){var f=n.getPadBorderExtents(t,r);i>=0&&(i+=f.w),l>=0&&(l+=f.h)}d(t,NaN,NaN,i,l)};var u={l:0,t:0,w:0,h:0};return n.setMarginBox=function(e,i,f){e=o.byId(e);var g=f||r.getComputedStyle(e),c=i.w,h=i.h,s=a(e)?u:n.getPadBorderExtents(e,g),b=n.getMarginExtents(e,g);if(t("webkit")&&l(e)){var y=e.style;c>=0&&!y.width&&(y.width="4px"),h>=0&&!y.height&&(y.height="4px")}c>=0&&(c=Math.max(c-s.w-b.w,0)),h>=0&&(h=Math.max(h-s.h-b.h,0)),d(e,i.l,i.t,c,h)},n.isBodyLtr=function(t){return t=t||e.doc,"ltr"==(e.body(t).dir||t.documentElement.dir||"ltr").toLowerCase()},n.docScroll=function(o){var r=(o=o||e.doc).parentWindow||o.defaultView;return"pageXOffset"in r?{x:r.pageXOffset,y:r.pageYOffset}:(r=t("quirks")?e.body(o):o.documentElement)&&{x:n.fixIeBiDiScrollLeft(r.scrollLeft||0,o),y:r.scrollTop||0}},n.getIeDocumentElementOffset=function(t){return{x:0,y:0}},n.fixIeBiDiScrollLeft=function(o,r){r=r||e.doc;var i=t("ie");if(i&&!n.isBodyLtr(r)){var d=t("quirks"),l=d?e.body(r):r.documentElement,a=e.global;return 6==i&&!d&&a.frameElement&&l.scrollHeight>l.clientHeight&&(o+=l.clientLeft),i<8||d?o+l.clientWidth-l.scrollWidth:-o}return o},n.position=function(r,i){r=o.byId(r);var d=e.body(r.ownerDocument),l=f(r);if(l={x:l.left,y:l.top,w:l.right-l.left,h:l.bottom-l.top},t("ie")<9&&(l.x-=t("quirks")?d.clientLeft+d.offsetLeft:0,l.y-=t("quirks")?d.clientTop+d.offsetTop:0),i){var a=n.docScroll(r.ownerDocument);l.x+=a.x,l.y+=a.y}return l},n.getMarginSize=function(t,e){t=o.byId(t);var i=n.getMarginExtents(t,e||r.getComputedStyle(t)),d=f(t);return{w:d.right-d.left+i.w,h:d.bottom-d.top+i.h}},n.normalizeEvent=function(e){if("layerX"in e||(e.layerX=e.offsetX,e.layerY=e.offsetY),!("pageX"in e)){var o=e.target,r=o&&o.ownerDocument||document,i=t("quirks")?r.body:r.documentElement;e.pageX=e.clientX+n.fixIeBiDiScrollLeft(i.scrollLeft||0,r),e.pageY=e.clientY+(i.scrollTop||0)}},n}));