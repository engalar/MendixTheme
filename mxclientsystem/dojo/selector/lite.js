define(["../has","../_base/kernel"],(function(e,r){"use strict";var n=document.createElement("div"),t=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector,o=n.querySelectorAll,u=/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g;e.add("dom-matches-selector",!!t),e.add("dom-qsa",!!o);var a=function(n,t){if(f&&n.indexOf(",")>-1)return f(n,t);var u=t?t.ownerDocument||t:r.doc||document,s=(o?/^([\w]*)#([\w\-]+$)|^(\.)([\w\-\*]+$)|^(\w+$)/:/^([\w]*)#([\w\-]+)(?:\s+(.*))?$|(?:^|(>|.+\s+))([\w\-\*]+)(\S*$)/).exec(n);if(t=t||u,s){var l=8===e("ie")&&e("quirks")?t.nodeType===u.nodeType:null!==t.parentNode&&9!==t.nodeType&&t.parentNode===u;if(s[2]&&l){var d;if(!(d=r.byId?r.byId(s[2],u):u.getElementById(s[2]))||s[1]&&s[1]!=d.tagName.toLowerCase())return[];if(t!=u)for(var m=d;m!=t;)if(!(m=m.parentNode))return[];return s[3]?a(s[3],d):[d]}if(s[3]&&t.getElementsByClassName)return t.getElementsByClassName(s[4]);if(s[5]){if(d=t.getElementsByTagName(s[5]),!s[4]&&!s[6])return d;n=(s[4]||"")+s[6]}}if(o)return 1===t.nodeType&&"object"!==t.nodeName.toLowerCase()?i(t,n,t.querySelectorAll):t.querySelectorAll(n);d||(d=t.getElementsByTagName("*"));for(var g=[],v=0,p=d.length;v<p;v++){var h=d[v];1==h.nodeType&&c(h,n,t)&&g.push(h)}return g},i=function(e,r,n){var t=e,o=e.getAttribute("id"),a=o||"__dojo__",i=e.parentNode,c=/^\s*[+~]/.test(r);if(c&&!i)return[];o?a=a.replace(/'/g,"\\$&"):e.setAttribute("id",a),c&&i&&(e=e.parentNode);for(var f=r.match(u),s=0;s<f.length;s++)f[s]="[id='"+a+"'] "+f[s];r=f.join(",");try{return n.call(e,r)}finally{o||t.removeAttribute("id")}};if(!e("dom-matches-selector"))var c=function(){var e="div"==n.tagName?"toLowerCase":"toUpperCase",r={"":function(r){return r=r[e](),function(e){return e.tagName==r}},".":function(e){var r=" "+e+" ";return function(n){return n.className.indexOf(e)>-1&&(" "+n.className+" ").indexOf(r)>-1}},"#":function(e){return function(r){return r.id==e}}},t={"^=":function(e,r){return 0==e.indexOf(r)},"*=":function(e,r){return e.indexOf(r)>-1},"$=":function(e,r){return e.substring(e.length-r.length,e.length)==r},"~=":function(e,r){return(" "+e+" ").indexOf(" "+r+" ")>-1},"|=":function(e,r){return 0==(e+"-").indexOf(r+"-")},"=":function(e,r){return e==r},"":function(e,r){return!0}};function o(e){return function(r,n){for(;(r=r.parentNode)!=n;)if(e(r,n))return!0}}function u(e){return function(r,n){return r=r.parentNode,e?r!=n&&e(r,n):r==n}}var a={};function i(e,r){return e?function(n,t){return r(n)&&e(n,t)}:r}return function(e,n,c){var f=a[n];if(!f){if(n.replace(/(?:\s*([> ])\s*)|(#|\.)?((?:\\.|[\w-])+)|\[\s*([\w-]+)\s*(.?=)?\s*("(?:\\.|[^"])+"|'(?:\\.|[^'])+'|(?:\\.|[^\]])*)\s*\]/g,(function(e,n,a,c,s,l,d){return c?f=i(f,r[a||""](c.replace(/\\/g,""))):n?f=(" "==n?o:u)(f):s&&(f=i(f,function(e,r,n){var o=r.charAt(0);'"'!=o&&"'"!=o||(r=r.slice(1,-1)),r=r.replace(/\\/g,"");var u=t[n||""];return function(n){var t=n.getAttribute(e);return t&&u(t,r)}}(s,d,l))),""})))throw new Error("Syntax error in query");if(!f)return!0;a[n]=f}return f(e,c)}}();if(!e("dom-qsa"))var f=function(e,r){for(var n=e.match(u),t=[],o=0;o<n.length;o++){(e=new String(n[o].replace(/\s*$/,""))).indexOf=escape;for(var i=a(e,r),c=0,f=i.length;c<f;c++){var s=i[c];t[s.sourceIndex]=s}}var l=[];for(o in t)l.push(t[o]);return l};return a.match=t?function(e,r,n){return n&&9!=n.nodeType?i(n,r,(function(r){return t.call(e,r)})):t.call(e,r)}:c,a}));